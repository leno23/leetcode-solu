672. 灯泡开关 Ⅱ

房间中有 n 只已经打开的灯泡，编号从 1 到 n 。墙上挂着 4 个开关 。

这 4 个开关各自都具有不同的功能，其中：

开关 1 ：反转当前所有灯的状态（即开变为关，关变为开）
开关 2 ：反转编号为偶数的灯的状态（即 2, 4, ...）
开关 3 ：反转编号为奇数的灯的状态（即 1, 3, ...）
开关 4 ：反转编号为 j = 3k + 1 的灯的状态，其中 k = 0, 1, 2, ...（即 1, 4, 7, 10, ...）
你必须 恰好 按压开关 presses 次。每次按压，你都需要从 4 个开关中选出一个来执行按压操作。

给你两个整数 n 和 presses ，执行完所有按压之后，返回 不同可能状态 的数量。

 

示例 1：

输入：n = 1, presses = 1
输出：2
解释：状态可以是：
- 按压开关 1 ，[关]
- 按压开关 2 ，[开]

```js
/**
 * @param {number} n
 * @param {number} presses
 * @return {number}
 */
var flipLights = function (n, presses) {
    // 1 0 0 0 0 0 0   0 0 0 0 0 0 
    // 2 0 1 0 1 0 1   0 1 0 1 0 1
    // 3 1 0 1 0 1 0   1 0 1 0 1 0
    // 4 1 0 0 1 0 0   1 0 0 1 0 0 
    //   1 2 3 4 5 6   7 8 9 10 11 12
    // 将1234四个开关各按一次可以发现灯泡的状态每6个具有周期性重复,所以只需要考虑前6个灯泡的状态即可
    // 又因为按偶数次相当于没有按，奇数次的按会影响状态，记1234分别按了abcd次
    // 那么，前6个灯泡的状态为
    // nk+1 (a+c+d)%2
    // nk+2 (a+b)%2
    // nk+3 (a+c)%2
    // nk+4 (a+b+d)%2
    // nk+5 (a+c)%2
    // nk+6 (a+b)%2
    // 可以看到nk+2和nk+6状态一样 nk+3和nk+5状态一样，所以只需要计算前4盏灯的状态
    // 然后，再看nk+1和nk+3的状态，他们都受ac影响，如果d为奇数，则他们状态相反，如果d是偶数，他们状态相同
    // 再看nk+2和nk+4的状态，他们都受ab影响，如果d为奇数，则他们状态相反，如果d是偶数，他们状态相同
    // 所以一旦1的状态确定下来，那么d的奇偶性就确定下来了，在加上2的状态，就可以确定出来4的状态
    // 因此，只需要确定前三个灯泡的状态即可

    // 不按也是一种状态
    if (presses == 0) {
        return 1;
    }
    //特殊情况处理
    // 一个灯泡只有亮与不亮
    if (n == 1) {
        // 按下134之后不亮   按下2之后亮
        return 2; 
    } else if (n == 2) {
        // 两盏灯  按一次 有三种
        // 起始状态            11
    //第一次按      00      10     10      10
    //第二次按    11 01   10 00   01 11   01 11 
    //           10 10   11 11   00 00   00 00
    // 可以看到，如果按一次，可以得到 00 01 10三种情况
    // 如果按两次可以得到  11 01 10 00 四种情况
        return presses == 1 ? 3 : 4;
    } else {
        // 三个灯泡时同样枚举按一次和按两次的情况
        // 起始状态                 111
        // 第一次按      000      101      010      011
        // 第二次按    111 010   010 111  101 000  100 001 
        //            101 100   000 001  111 110  110 111
        // 可以看到 按一次会出现000 010 101 100四种情况
        // 按两次会出现 111 010 101 100 001 000 110  7中情况 没有011
        // 而按3次的时候已经可以出现011状态，也就是会有8种情况
        // 而根据上面分析可以知道确定三盏灯泡的状态后面所有的灯泡状态都可以确定下来
        // 也就是三盏灯泡的状态和 >3盏灯泡的状态是等价的，因此得出结果
        return presses == 1 ? 4 : presses == 2 ? 7 : 8;
    }
};