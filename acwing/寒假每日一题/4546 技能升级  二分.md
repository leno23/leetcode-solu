4656. 技能升级

小蓝最近正在玩一款 RPGRPG 游戏。

他的角色一共有 NN 个可以加攻击力的技能。

其中第 ii 个技能首次升级可以提升 AiAi 点攻击力，以后每次升级增加的点数都会减少 BiBi。

⌈AiBi⌉⌈AiBi⌉（上取整）次之后，再升级该技能将不会改变攻击力。

现在小蓝可以总计升级 MM 次技能，他可以任意选择升级的技能和次数。

请你计算小蓝最多可以提高多少点攻击力？

#### 输入格式

输入第一行包含两个整数 NN 和 MM。

以下 NN 行每行包含两个整数 AiAi 和 BiBi。

#### 输出格式

输出一行包含一个整数表示答案。

#### 数据范围

对于 40%40% 的评测用例，1≤N,M≤10001≤N,M≤1000；  
对于 60%60% 的评测用例，1≤N≤1041≤N≤104，1≤M≤1071≤M≤107；  
对于所有评测用例，1≤N≤1051≤N≤105，1≤M≤2×1091≤M≤2×109，1≤Ai,Bi≤1061≤Ai,Bi≤106。

#### 输入样例：

```
3 6
10 5
9 2
8 1
```

#### 输出样例：

```
47
```



```py
from math import ceil
n,m=[int(x)for x in input().split()]

'''
为了使得升级m次技能后提高的攻击力最高，可以每次贪心的从几个技能中选择提供攻击力最高的技能进行升级
例如 
3 6
10 5
9 2
8 1

10 5 0
9 7 5 3 1
8 7 6 5 4


提升攻击力值依次为 10 9 8 7 7 6 到了6之后用完了M次
然后，求和即可得到最高提升的攻击力

但是,由于M是10**9数量级，这种做法会TLE

注意到攻击力值一定是单调递减的，可以使用二分找到 提升攻击力为x时，需要升级的次数，x越小 次数越大
这样，就可以找到升级次数 >=M的 x 

因为要取>=x的攻击力升级m次，记cnt为 >l的攻击力升级后的攻击力总和，剩下的m-cnt次攻击力就是取x了

例如10 5 计算提升攻击力大于x的升级次数，即在10 8 6 4 ... 数列中找到数字大于x的数字的个数，应该有ceil((10-x)/2)
 = ceil((10-x)/5)

1.大于x的攻击力部分 使用等差数列性质计算
    对于每一个技能，对应一个等差递减数列 项数为ceil((Ai-x)/Bi) 首项Ai  可以求出总和
2.剩余的m-cnt使用攻击力x

最终结果两项求和

'''


# 等差数列 尾项为r 项数为n，差为t的和
def sm(r,n,t):
    l=r-t*(n-1)
    return (l+r)*n//2

# 检查升级到攻击力x，需要用的次数是否不大于M
def check(x):
    res =0
    for i in range(n):
        if a[i] >x:
            res += ceil((a[i]-x)/b[i])
    return res <= m

l,r=0,10**6+10
cnt,ans=0,0
a,b=[0]*(n+1),[0]*(n+1)
for i in range(n):
    a1,a2=[int(x) for x in input().split()]
    a[i]=a1
    b[i]=a2

while l<r:
    mid=(l+r)//2
    if not check(mid):
        l=mid + 1
    else:
        r=mid
    
print(l)
for i in range(n):
    if a[i]>l:
        now = ceil((a[i]-l) /b[i])
        cnt+=now
        ans += sm(a[i],now,b[i])

print(ans + l*(m-cnt))